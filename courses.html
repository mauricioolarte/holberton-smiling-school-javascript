<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="icon" type="image/x-icon" href="images/favicon.ico">
	<link rel="icon" type="image/png" href="images/favicon.png">
	<title>Document</title>
	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Coiny&display=swap" rel="stylesheet">

	<script src="https://code.jquery.com/jquery-3.4.1.min.js"
		integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
		integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
		crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
		integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
		crossorigin="anonymous"></script>

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
		integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<script src="https://use.fontawesome.com/7162430c1a.js"></script>
	<link rel="stylesheet" href="styles.css">
</head>

<body>
	<header class="courses pt-3 pb-0">
		<nav class="navbar navbar-expand-lg">
			<div class="container">
				<a class="navbar-brand mx-auto d-flex flex-column align-items-center" href="#">
					<img src="images/smile_off.png" height="30px" alt="">
					<img src="images/logo.png" height="35px" alt="">
				</a>
				<button class="navbar-toggler main-toggler" type="button" data-toggle="collapse"
					data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
					aria-label="Toggle navigation">
					<span class="navbar-toggler">o</span>
				</button>

				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<ul class="navbar-nav ml-auto text-uppercase">
						<li class="nav-item">
							<a class="nav-link text-white" href="#">courses</a>
						</li>
						<li class="nav-item">
							<a class="nav-link text-white" href="#">pricing</a>
						</li>
						<li class="nav-item">
							<a class="nav-link text-white" href="#">login</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<div class="container mt-5">
			<h3 class="h1-responsive my-5 title-courses">« Don’t cry because it’s over.<br> <span
					class="resal">Smile</span> because it happened. »</h3>
		</div>


		<main>
			<section class="section-search container-fluid text-white py-3">
				<div class="container-lg">
					<nav class="navbar row">
						<div class="input-group col-md-4 my-3">
							<h6 class="font-weight-bold text-uppercase text-left">Keywords</h6>
							<div class="input-group-prepend w-100">
								<span
									class="font-icon-filter input-group-text bg-transparent border-0 border-bottom bg-span"><i
										class="fa fa-search" aria-hidden="true"></i></span>
								<input class="form-control form-control-sm sear-btn text-black" type="text"
									placeholder="Search by keywords" aria-label="Search" id="searchInput" />
							</div>
						</div>
						<div class="col-md-4 col-sm-6 my-3">
							<h6 class="font-weight-bold text-uppercase text-left">Topic</h6>
							<div class="dropdown rounded-0">
								<div class="loaderTopic"></div>
								<select class="btn btn-lg sear-btn" aria-label="Default select example"
									id="topicsValues">
								</select>
							</div>
						</div>
						<div class="col-md-4 col-sm-6 my-3">
							<h6 class="font-weight-bold text-uppercase text-left">Sort by</h6>
							<div class="dropdown">
								<div class="loaderSort"></div>

								<select class="btn btn-lg dropdown-toggle text-white sear-btn"
									aria-label="Default select example" id="sortValues">
								</select>
							</div>
						</div>
					</nav>
				</div>
			</section>
		</main>
	</header>

	<section class="container my-5">
		<div class="spaceVideos" id="spaceVideos">
			<div class="loader"></div>

		</div>
	</section>

	<!-- footer -->
	<footer class="footer py-5">
		<div class="container-lg">
			<div class="footer-content d-flex align-items-center flex-column flex-sm-row mx-auto ml-sm-0">
				<div class="logo d-flex align-items-center py-3 ml-sm-0">
					<a href="#">
						<img src="images/smile_off.png" height="30"></a>
					<img src="images/logo.png" height="35">
					</a>
				</div>
				<div class="social d-flex text-white mt-2 my-4 ml-sm-auto">
					<div class="nav-item"><a href="#" class="holberton_school-icon-ic_facebook h1 text-white"></a></div>
					<div class="nav-item"><a href="#" class="holberton_school-icon-ic_twitter h1 text-white"></a></div>
					<div class="nav-item"><a href="#" class="holberton_school-icon-ic_instagram h1 text-white"></a>
					</div>
				</div>
			</div>
			<p class="copyright text-center my-3 text-white-50">©smileschool 2020</p>
		</div>
	</footer>
</body>

<script>
	$(document).ready(async function () {

		/* topics */

		await $.get("https://smileschool-api.hbtn.info/courses", function (dat, status) {
			let values = dat.topics
			console.log(values)
			let selectTopic = $("#topicsValues")
			for (let i = 0; i < values.length; i++) {
				let topics = document.createElement("option")
				topics.value = values[i]
				topics.innerText = values[i]
				selectTopic.append(topics)
			}
			$(".loaderTopic").hide()
		})
		/* sort values menu */
		await $.get("https://smileschool-api.hbtn.info/courses", function (dat, status) {
			let values = dat.sorts
			console.log(values)
			let selectSort = $("#sortValues")
			for (let j = 0; j < values.length; j++) {
				let sorts = document.createElement("option")
				console.log(sorts)
				sorts.value = values[j]
				sorts.innerText = values[j].replace("_", " ")
				selectSort.append(sorts)
			}
			$(".loaderSort").hide()

		})


		/* courses */

		loadVideos()

		/* change on topics */

		$('#topicsValues').change(function () {
			console.log($('#topicsValues').val())
			loadVideos("https://smileschool-api.hbtn.info/courses", $('#searchInput').val(), $("#topicsValues").val(), $('#sortValues').val())
		})

		/* change on sort */
		$('#sortValues').change(function () {
			console.log($('#sortValues').val())
			loadVideos("https://smileschool-api.hbtn.info/courses", $('#searchInput').val(), $("#topicsValues").val(), $('#sortValues').val())
		})

		/*change on search */
		$('#searchInput').change(function () {
			$("loader").show()
			console.log($('#searchInput').val())
			loadVideos("https://smileschool-api.hbtn.info/courses", $('#searchInput').val(), $("#topicsValues").val(), $('#sortValues').val())
			$("loader").hide()
		})

	})

	async function loadVideos(url = "https://smileschool-api.hbtn.info/courses", keyword = "", topic = "All", sort_by = "most_popular") {

		$("#spaceVideos").replaceWith('<div class="spaceVideos" id="spaceVideos"></div >')
		$("#spaceVideos").append('<div class="loader"></div>')

		await $.get(url, {
			q: keyword,
			topic: topic,
			sort: sort_by
		}, function (dat, status) {

			let data = dat.courses

			console.log(data)
			console.log(status)
			let Container = $("#spaceVideos")
			for (let i = 0; i < data.length; i++) {

				let cardContainer = document.createElement("div")
				cardContainer.className = "card border-0 m-1"
				cardContainer.style = "width: 12rem;"

				/* card elements*/
				/* images */
				let imageVideo = document.createElement("img")
				imageVideo.className = "card-img-top d-block"
				imageVideo.src = data[i].thumb_url

				let imagePlayIcon = document.createElement("img")
				imagePlayIcon.className = "position-absolute"
				imagePlayIcon.src = "images/play.png"
				imagePlayIcon.width = "60"

				/* card body video*/

				let cardBodyVideo = document.createElement("div")
				cardBodyVideo.className = "card-body mx-0 px-0"

				let cardBodyVideo1 = document.createElement("div")

				let titleVideo = document.createElement("h5")
				titleVideo.className = "font-weight-bold"
				titleVideo.textContent = data[i].title
				let subTitle = document.createElement("p")
				subTitle.className = "card-text"
				subTitle.textContent = data[i]['sub-title']

				cardBodyVideo1.append(titleVideo)
				cardBodyVideo1.append(subTitle)

				/* author image and name */
				let authorVideoImageContainer = document.createElement("span")
				authorVideoImageContainer.className = "d-flex flex-row"
				let authorVideoImage = document.createElement("img")
				authorVideoImage.className = "rounded-circle"
				authorVideoImage.width = "35"
				authorVideoImage.height = "35"
				authorVideoImage.src = data[i].author_pic_url
				let authorVideoName = document.createElement("p")

				authorVideoName.className = "font-weight-bold ml-2 mt-1"
				authorVideoName.textContent = data[i].author

				cardBodyVideo1.append(authorVideoImageContainer)

				authorVideoImageContainer.append(authorVideoImage)
				authorVideoImageContainer.append(authorVideoName)

				/* starts */
				let starsTimeContainer = document.createElement("span")
				starsTimeContainer.className = "d-flex flex-row justify-content-between"
				let starsContainer = document.createElement("span")
				let starImage1 = document.createElement("img")
				starImage1.src = "images/star_on.png"
				starImage1.width = "15"
				starImage1.className = "star-1"
				let starImage2 = document.createElement("img")
				starImage2.src = "images/star_on.png"
				starImage2.width = "15"
				starImage2.className = "star-2"
				let starImage3 = document.createElement("img")
				starImage3.src = "images/star_on.png"
				starImage3.width = "15"
				starImage3.className = "star-3"
				let starImage4 = document.createElement("img")
				starImage4.src = "images/star_on.png"
				starImage4.width = "15"
				starImage4.className = "star-4"
				let starImage5 = document.createElement("img")
				starImage5.src = "images/star_on.png"
				starImage5.width = "15"
				starImage5.className = "star-5"

				let starTime = document.createElement("p")
				starTime.className = "profile-video p-0 m-0"
				starTime.textContent = data[i].duration

				starsContainer.append(starImage1)
				starsContainer.append(starImage2)
				starsContainer.append(starImage3)
				starsContainer.append(starImage4)
				starsContainer.append(starImage5)

				starsTimeContainer.append(starsContainer)
				starsTimeContainer.append(starTime)

				cardBodyVideo.append(cardBodyVideo1)
				cardBodyVideo.append(starsTimeContainer)

				cardContainer.append(imageVideo)
				cardContainer.append(imagePlayIcon)
				cardContainer.append(cardBodyVideo)

				Container.append(cardContainer)
				$(".loader").hide()
			}
		})
	}


</script>

</html>